{"version":3,"sources":["js/RainShader.js","js/data.js","js/Points.js","js/Cloud.js","js/FlashLight.js","js/Map.js","js/UpdateCamera.js","js/worldToScreen.js","js/RainShaderClickable.js","js/PointsClickable.js","js/Scene.js","js/createMarkup.js","js/headContainer.js","js/SoundControl.js","js/Step.js","js/Audio.js","js/DeathTollDiv.js","js/NumberCount.js","js/Tooltip.js","js/SearchBar.js","js/CreditCard.js","js/MainCtn.js","js/Main.js","js/Navbar.js","js/App.js","index.js"],"names":["RainShader","vertexShader","fragmentShader","animationTime","dateArr","audioData","src","key","death_to_date","weeklyData","newDeathsPerWeek","stepPoint","chimeDelay","allDeathToll","length","stepTooltipArr","tooltipPos","x","y","z","victimData","id","season","name","descriptor","location","county","age","React","memo","props","step","COUNT","uNowTime","startTime","randomNumArr","isMobile","stepNum","highlightArr","lastStepNum","console","log","mesh","useRef","mat","useLoader","TextureLoader","useFrame","state","delta","rainDrop","current","material","uniforms","uTime","value","clock","elapsedTime","uOldTime","oldTime","uHoverIdx","geometry","attributes","position","needsUpdate","computeBoundingBox","vertices","aSpeed","aRandom","push","i","R","t","Math","PI","u","round","r","cos","sin","whichWeek","getRank","getOneThirdPosX","getOneThirdPosY","floor","idx","arr","rank","indexOf","pointPosByCounty","ref","attach","attachObject","count","array","Float32Array","itemSize","onUpdate","self","verticesNeedUpdate","transparent","depthTest","args","blending","AdditiveBlending","uniforms-uTime","uniforms-uOldTime","uniforms-uStartTime","uniforms-uHoverIdx","uniforms-uLastHighlight","uniforms-uIsMobile","uniforms-uHighlight","uniforms-uStep","Cloud","rotation","colorMap","opacity","side","DoubleSide","map","Light","flash","random","power","set","Map","scale","tweenCamera","camera","cameraPos","pos","TWEEN","Tween","to","easing","Easing","Quadratic","Out","start","theta","useThree","gl","scene","fov","near","far","allTooltips","document","querySelectorAll","forEach","posX","dataset","posx","posY","posy","newPos","vector","renderer","domElement","project","worldToScreen","THREE","style","left","toFixed","top","useState","cameraInitPos","setCameraInitPos","useEffect","targetBox","getObjectByName","targetPos","tPos","lookAt","updateProjectionMatrix","update","degToRad","prev","next","RainShaderClickable","timer","tooltipTimer","clickedIdx","deathData","pointByCountyPosWithName","nowTime","performance","now","filter","hoverIdx","clearTimeout","setTimeout","tooltipCtn","select","classed","clickedData","html","onPointerOver","event","index","namesData","querySelector","pointer","audioFile","currentTime","volume","play","hovered","tooltipCtn2","pageY","pageX","onPointerOut","CameraController","controls","OrbitControls","minDistance","maxDistance","dispose","Scene","width","dpr","min","window","devicePixelRatio","format","outputEncoding","visible","color","Text","fontSize","anchorX","anchorY","fallback","createMarkup","htmlContent","__html","HeadContainer","prop","onClickFn","currentStepIndex","hed","dek","byline","className","dangerouslySetInnerHTML","onClick","SoundControl","onSouncControlClick","audioEnabled","circleRef","inHover","setHover","aTime","cur_Circle","attr","transition","duration","ease","easeLinear","onMouseEnter","onMouseLeave","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","cx","cy","strokeDasharray","strokeDashoffset","transform","points","d","x1","y1","x2","y2","data","stepIndex","data-step","muted","DeathTollDiv","num","spanRef","curStepNum","end","obj","getElementById","range","stepTime","abs","max","endTime","Date","getTime","run","remaining","innerHTML","toString","replace","clearInterval","setInterval","NumberCount","data-target","selectAll","data-posx","data-posy","data-count","animationDelay","SearchBar","setClickedIdx","parsedNames","names","inputRef","listRef","parsedNames_sorted","sort","a","b","name_sort","searchingNames","setSearchingNames","onItemClicked","target","type","placeholder","classList","add","onKeyUp","val","toUpperCase","name_display","getElementsByClassName","display","filterFunction","autoComplete","data-idx","forwardRef","remove","njCovidArr","njDeathData","setCurrentStepIndex","setStartTime","content","stepCtnRef","creditRef","setAudioEnabled","children","child","contains","showStep","innerWidth","innerHeight","screenSize","getScreenSize","setDimension","addEventListener","removeEventListener","useMemo","Array","apply","seedrandom","alea","generatePRNG","loop","endAudio","credits","Main","Navbar","searchValue","handleChange","bind","handleSubmit","this","setState","open","preventDefault","njdcLinks","link","copy","navbarLinks","href","rel","text","alt","padding","encodeURIComponent","social","site_url","description","data-size","email_subj","email_body","Component","App","isIE","ReactDOM","render"],"mappings":"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","file":"static/js/main.9b8a71a7.chunk.js","sourcesContent":["const RainShader = {\n    vertexShader: `\n    #define PI 3.14159265359\n    uniform float uTime;\n    uniform float uHighlight;\n    uniform float uOldTime;\n    uniform float uStartTime;\n    uniform float uLastHighlight;\n    uniform float uHoverIdx;\n    uniform float uIsMobile;\n    uniform float uStep;\n    attribute vec3 aSpeed;\n    attribute vec3 aEndPosition;\n    attribute vec2 aRandom;\n\n      // chime delays saved array by step\n    float chimeDelays[34] = float[34](4.87, 4.55, 4.6, 4.65, 5.55, \n      5.6, 5.65, 6.52, 6.54, 6.55, \n      4.95, 5.18, 5.6, 5.0, 5.18, 5.8,\n      4.95, 5.18, 5.6, 5.15, 5.38, \n      5.48, 4.8, 5.13, 5.45, 4.8, \n      5.12, 5.58,4.92,5.18, 5.55,4.9, 5.18, 5.38);\n    vec3 mod289(vec3 x) {\n      return x - floor(x * (1.0 / 289.0)) * 289.0;\n    }\n\n    vec2 mod289(vec2 x) {\n      return x - floor(x * (1.0 / 289.0)) * 289.0;\n    }\n\n    vec3 permute(vec3 x) {\n      return mod289(((x*34.0)+1.0)*x);\n    }\n\n    float snoise(vec2 v){\n      const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n                          0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n                        -0.577350269189626,  // -1.0 + 2.0 * C.x\n                          0.024390243902439); // 1.0 / 41.0\n    // First corner\n      vec2 i  = floor(v + dot(v, C.yy) );\n      vec2 x0 = v -   i + dot(i, C.xx);\n\n    // Other corners\n      vec2 i1;\n      //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n      //i1.y = 1.0 - i1.x;\n      i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n      // x0 = x0 - 0.0 + 0.0 * C.xx ;\n      // x1 = x0 - i1 + 1.0 * C.xx ;\n      // x2 = x0 - 1.0 + 2.0 * C.xx ;\n      vec4 x12 = x0.xyxy + C.xxzz;\n      x12.xy -= i1;\n\n    // Permutations\n      i = mod289(i); // Avoid truncation effects in permutation\n      vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\n        + i.x + vec3(0.0, i1.x, 1.0 ));\n\n      vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n      m = m*m ;\n      m = m*m ;\n      vec3 x = 2.0 * fract(p * C.www) - 1.0;\n      vec3 h = abs(x) - 0.5;\n      vec3 ox = floor(x + 0.5);\n      vec3 a0 = x - ox;\n      m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n    // Compute final noise value at P\n      vec3 g;\n      g.x  = a0.x  * x0.x  + h.x  * x0.y;\n      g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n      return 130.0 * dot(m, g);\n    }\n\n    vec3 getCurvePosition(float posX, float posY, float posZ){\n        float noiseScale = 0.005;\n        float newPosY = snoise( vec2( posX * noiseScale + ( uTime/10.) , posZ * noiseScale+ ( uTime/10. ) ) );\n        vec3 newPos = vec3(0.);\n        newPos.x = posX + aRandom.x *5.;\n        newPos.z = posZ + sin(aRandom.y) *5.+100.*uIsMobile;\n        newPos.y = newPosY * 30.;\n        return newPos;\n    }\n\n    void main() {\n        float fullAnimeTime = 15.0;\n        float posX = position.x;\n        float posY = position.y;\n        float posZ = position.y;\n        vec4 mvPosition = vec4(0.);\n        float timeChanged = uTime*2.;\n        float timer = smoothstep( 0.0, 2.0, timeChanged);\n        vec3 newPos = getCurvePosition(posX, posY, posZ);\n        float xPos_start = -250.;\n        vec3 transformed = vec3(newPos.x, newPos.y+120., newPos.z-80.);\n        vec3 transformedNew = transformed.xyz;\n        float padding = 5.0;\n        vec4 finalFinalPos = vec4(0.);\n        float stepTime = (uOldTime - uStartTime)*0.001;\n        float yPadding = aSpeed.z/10.;\n        vec3 endPoint = vec3(0.);\n        float barY = (uIsMobile>0.)? -350.: -265.;\n        // aSpeed: x:index, y: rank, z:newDeathsPerWeek\n\n        if(uHighlight == 0.){\n          vec3 finalPos = mix(position, newPos, timer);\n          // vec3 newEndPos = vec3(aEndPosition.x, aEndPosition.y+6.0* sin(uTime+aRandom.y*6.),aEndPosition.z);\n          // finalFinalPos = vec4(aEndPosition, 1.0);\n          finalFinalPos = vec4(finalPos, 1.0);\n        } else if(uHighlight <= 10. ){\n          // the first 11 particles have special pace\n          if( aSpeed.x < uLastHighlight ){\n            // old dots fall into a barchart \n            transformedNew.z = -(aRandom.y * yPadding)-50.; \n            transformedNew.x = xPos_start + aSpeed.y * padding + aRandom.x*2.;\n            transformedNew.y = barY;\n          } else if(aSpeed.x >= uLastHighlight && aSpeed.x < uHighlight){\n            // others fall into 3*3 matrix; \n            float timer1_1 = smoothstep( 0., chimeDelays[int(aSpeed.x)], stepTime ); \n            float timer1_2 = smoothstep( fullAnimeTime-2.0-aRandom.y, fullAnimeTime-1.25, stepTime ); \n            vec3 endPoint = vec3( 400.* (aRandom.x-.5), -50.-200.*aRandom.y, 0.);\n                        \n            if( stepTime-fullAnimeTime+2.0+aRandom.y <= 0.){ \n              transformedNew = mix(transformed, endPoint, timer1_1);\n            } else { \n              // 3*3 end matrix to bar\n              transformedNew = mix(endPoint, vec3((xPos_start + aSpeed.y * padding + aRandom.x*2.), barY, -(aRandom.y * yPadding)-50.), timer1_2);\n            }\n          }\n          finalFinalPos = vec4( transformedNew, 1.0 );\n        } else if(uLastHighlight == 33222.){\n          // The last step\n          // vec3 newEndPos = vec3(aEndPosition.x, aEndPosition.y+6.0* sin(uTime+aRandom.y*6.),aEndPosition.z);\n          float timer1_2 = smoothstep( 0.0, fullAnimeTime*0.2, stepTime ); \n          transformedNew = mix(vec3( xPos_start + aSpeed.y * padding + aRandom.x*2., barY, -( aRandom.y * yPadding)-50.), aEndPosition, timer1_2);\n          finalFinalPos =  vec4( transformedNew, 1.0 );\n        } else { \n          if(aSpeed.x < uLastHighlight){\n            // old dots fall into a barchart\n            transformedNew.z = -(aRandom.y * yPadding)-50.; \n            transformedNew.x = xPos_start + aSpeed.y * padding + aRandom.x*2.;\n            transformedNew.y = barY;\n          } else if(aSpeed.x >= uLastHighlight && aSpeed.x < uHighlight){\n            // the three dots got highlighted\n            if( aSpeed.x+3. >= uHighlight ){\n              float timer1_1 = smoothstep( 0., chimeDelays[int( 10.+3.* (uStep-3.0) + aSpeed.x+3.-uHighlight )] , stepTime ); \n              float timer1_2 = smoothstep( fullAnimeTime-2.0, fullAnimeTime-1.25, stepTime ); \n              vec2 point3 = (aSpeed.x+1.==uHighlight)?  vec2(-20., -80.): ((aSpeed.x+2.==uHighlight)? vec2(-120., -150.): vec2(60, -150.));\n              vec3 endPoint = vec3(point3, 0.);\n              if( stepTime-fullAnimeTime+2.0 <= 0.){ \n                transformedNew = mix(transformed, endPoint, timer1_1);\n              } else {\n                transformedNew = mix(endPoint, vec3((xPos_start + aSpeed.y * padding + aRandom.x*2.), barY, -(aRandom.y * yPadding)-50.), timer1_2);\n              }\n            } else {\n              // new dots do animation\n              float timer1_1 = smoothstep( (fullAnimeTime - 4.0 - mod( aSpeed.y, 12.) *.5) * aRandom.x, fullAnimeTime-1.0-aRandom.y, stepTime); \n              float timer1_2 = smoothstep( fullAnimeTime-2.0- aRandom.y, fullAnimeTime-1.25, stepTime ); \n              vec3 endPoint = vec3(transformed.x, xPos_start-mod(aSpeed.y, 12.)*100.-aRandom.y*100., transformed.z);\n              if( (uOldTime - uStartTime)*0.001 -fullAnimeTime+2.0+aRandom.y <= 0.){\n                // the first 8-9 sec -> rain drop\n                transformedNew = mix(transformed, endPoint, timer1_1);\n              } else {\n                // the later 9-10 sec -> move to bars\n                transformedNew = mix(endPoint, vec3( (xPos_start+ aSpeed.y * padding + aRandom.x*2.), barY ,-( aRandom.y * yPadding)-50. ), timer1_2);\n              }\n            }\n          } \n            finalFinalPos =  vec4( transformedNew, 1.0 );\n        }\n\n        mvPosition = modelViewMatrix * finalFinalPos;\n        gl_Position = projectionMatrix * mvPosition;\n        gl_PointSize =  1800.0 / -mvPosition.z  * max(abs(sin(uTime*2. +posY)), 0.4) + 5. + ((aSpeed.x <11.0|| (aSpeed.x>11.0 && (aSpeed.x+3.==uHighlight || aSpeed.x+1.==uHighlight || aSpeed.x+2.==uHighlight ) ) )? 8.: 2. );\n        // gl_PointSize =  1500.0 / -mvPosition.z * abs(sin(uTime*0.4+aRandom.x*10.)) + 3. + ((aSpeed.x <11.0|| (aSpeed.x>11.0 && (aSpeed.x+3.==uHighlight || aSpeed.x+1.==uHighlight || aSpeed.x+2.==uHighlight ) ) )? 8.: 2. );\n    }\n  `,\n    fragmentShader: `\n    uniform float uHighlight;\n    uniform float uLastHighlight;\n\n    float map(float value, float oldMin, float oldMax, float newMin, float newMax) {\n        return newMin + (newMax - newMin) * (value - oldMin) / (oldMax - oldMin);\n    }\n    float rand(vec2 co){\n      return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n    }\n    void main() { \n        //0, 180, 216, 0.07, 0.41, 0.59 // 19, 143, 189\n        // vec3 color = vec3(0.07, 0.56, 0.64+ .5* rand(gl_PointCoord.xy*2.0) );\n        vec3 color = vec3(rand(gl_PointCoord.xy*2.)*.7, 0.56, 0.74 + .5* rand(gl_PointCoord.xy*2.0) );\n        vec2 toCenter = (gl_PointCoord.xy - 0.5) * 4.0;\n        float len = length(toCenter);\n        float a = 1.0 - len;\n        gl_FragColor = vec4(color, (uLastHighlight==33222.0)? a*0.6: a);\n\n    }\n  `\n};\n\n//   fragmentShader: `\n//   uniform sampler2D pointTexture;\n//   void main() {\n//       vec3 color = vec3(1.0,1.0,1.0);\n//       gl_FragColor = vec4(color, 0.8);\n//       gl_FragColor = gl_FragColor * texture2D( pointTexture, gl_PointCoord );\n//   }\n// `\n\n// void main() {\n// vec3 transformed = position.xyz;\n// float velocity = -50.0 + aSpeed.x *40.0;\n// float cycle = mod(uTime, 50.0);\n// if(aSpeed.z <= uHighlight){\n//   transformed.y += (velocity * cycle);\n// } else {\n//   transformed.y = -400.0;\n// }\n//         vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n//         gl_Position = projectionMatrix * mvPosition;\n//     }\nexport { RainShader };\n","import weeklyData from \"../data/nj_parsed_weekly_death_data.json\";\n\nconst animeDuration = 15;\nexport const animationTime = [animeDuration, animeDuration, animeDuration, animeDuration, animeDuration, \n    animeDuration, animeDuration, animeDuration, animeDuration, animeDuration,\n    animeDuration];\nexport const dateArr=[\"Mar. ’20\", \"June ’20\", \"Sep. ’20\", \"Dec. ’20\", \"Mar. ’21\", \"June ’21\", \"Sep. ’21\", \"Dec. ’21 \", \"Mar. 22\", \"next\"]\n// export const stepTooltipArr = [[], [1], [2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [12, 13, 14], \n\nexport const audioData = [\n           { src: \"./audio/IntroDrone2.mp3\", key: \"introAudio\" },\n           { src: \"./audio/MainAudio_2022_04_17.mp3\", key: \"mainAudio\" },\n           { src: \"./audio/EndingDrone.mp3\", key: \"endingDrone\" },\n           { src: \"./audio/Chimes/h_BellPizz_01.mp3\", key: \"chime-1\" },\n           { src: \"./audio/Chimes/h_BellPizz_02.mp3\", key: \"chime-2\" },\n           { src: \"./audio/Chimes/h_BellPizz_03.mp3\", key: \"chime-3\" },\n           { src: \"./audio/Chimes/h_BellPizz_04.mp3\", key: \"chime-4\" },\n           { src: \"./audio/Chimes/h_BellPizz_05.mp3\", key: \"chime-5\" },\n           { src: \"./audio/Chimes/h_BellPizz_06.mp3\", key: \"chime-6\" },\n           { src: \"./audio/Chimes/h_BellPizz_07.mp3\", key: \"chime-7\" },\n           { src: \"./audio/Chimes/h_BellPizz_08.mp3\", key: \"chime-8\" },\n           { src: \"./audio/Chimes/h_BellPizz_09.mp3\", key: \"chime-9\" },\n           { src: \"./audio/Chimes/h_BellPizz_10.mp3\", key: \"chime-10\" },\n           { src: \"./audio/Chimes/h_BellPizz_11.mp3\", key: \"chime-11\" },\n           { src: \"./audio/Chimes/h_BellPizz_12.mp3\", key: \"chime-12\" }\n       ];\n\nexport const last_step = 11;\nexport const death_to_date = weeklyData[\"deathByWeek\"];\nexport const newDeathsPerWeek = weeklyData[\"deathPerWeek\"];\nexport const stepPoint = weeklyData[\"stepPoint\"];\nexport const chimeDelay = [\n        [0.77],\n        [0.95, 1.0, 1.05, 1.95, 2.0, 2.05, 2.92, 2.94, 2.95],\n        [4.95 - 3.6, 5.18 - 3.6, 5.6 - 3.6],\n        [5 - 3.6, 5.18 - 3.6, 5.8 - 3.6],\n\n        [4.95 - 3.6, 5.18 - 3.6, 5.6 - 3.6],\n        [5.15- 3.6, 5.38 - 3.6, 5.48 - 3.6],\n        [4.8 - 3.6, 5.13 - 3.6, 5.45 - 3.6],\n        [4.8 - 3.6, 5.12 - 3.6, 5.58 - 3.6],\n\n        [4.92 - 3.6, 5.18 - 3.6, 5.55 - 3.6],\n        [4.9 - 3.6, 5.18 - 3.6, 5.38 - 3.6],\n    ];\n\n\nexport const allDeathToll = death_to_date[death_to_date.length-1];\nexport const stepTooltipArr = [\n           [],\n           [1],\n           [2, 3, 4, 5, 6, 7, 8, 9, 10],\n           [11, 12, 13],\n           [14, 15, 16],\n           [17, 18, 19],\n           [20, 21, 22],\n           [23, 24, 25],\n           [26, 27, 28],\n           [29, 30, 31],\n           [32, 33, 34]\n       ];\nexport const tooltipPos = [\n           // -168, -32, 100 \n           // (-160, -70, 0), (0, -130, 0 ) , -220, -40, 140\n           { x: 2, y: -60, z: 0 },\n           { x: -220, y: -50, z: 0 },\n           { x: -40, y: -50, z: 0 },\n           { x: 120, y: -50, z: 0 },\n           { x: -220, y: -110, z: 0 },\n           { x: -40, y: -110, z: 0 },\n           { x: 120, y: -110, z: 0 },\n           { x: -220, y: -200, z: 0 },\n           { x: -40, y: -200, z: 0 },\n           { x: 120, y: -200, z: 0 },\n\n           { x: -20, y: -80, z: 0 },\n           { x: -120, y: -150, z: 0 },\n           { x: 60, y: -150, z: 0 },\n\n           { x: -20, y: -80, z: 0 },\n           { x: -120, y: -150, z: 0 },\n           { x: 60, y: -150, z: 0 },\n\n           { x: -20, y: -80, z: 0 },\n           { x: -120, y: -150, z: 0 },\n           { x: 60, y: -150, z: 0 },\n\n           { x: -20, y: -80, z: 0 },\n           { x: -120, y: -150, z: 0 },\n           { x: 60, y: -150, z: 0 },\n\n           { x: -20, y: -80, z: 0 },\n           { x: -120, y: -150, z: 0 },\n           { x: 60, y: -150, z: 0 },\n\n           { x: -20, y: -80, z: 0 },\n           { x: -120, y: -150, z: 0 },\n           { x: 60, y: -150, z: 0 },\n\n           { x: -20, y: -80, z: 0 },\n           { x: -120, y: -150, z: 0 },\n           { x: 60, y: -150, z: 0 },\n\n           { x: -20, y: -80, z: 0 },\n           { x: -120, y: -150, z: 0 },\n           { x: 60, y: -150, z: 0 }\n       ];\nexport const victimData = [\n           {\n               id: 1,\n               season: \"opening\",\n               name: \"John Brennan\",\n               descriptor: \"Horse Trainer\",\n               location: \"Little Ferry\",\n               county: \"Bergen\",\n               age: 69\n           },\n           {\n               id: 2,\n               season: \"opening\",\n               name: \"Wallace Roney\",\n               descriptor: \"Grammy-winning trumpeter\",\n               location: \"Clifton\",\n               county: \"Passaic\",\n               age: 59\n           },\n           {\n               id: 3,\n               season: \"opening\",\n               name: \"Marta Schreier\",\n               descriptor: \"Amateur pianist\",\n               location: \"Westfield\",\n               county: \"Union\",\n               age: 87\n           },\n           {\n               id: 4,\n               season: \"opening\",\n               name: \"Donald Landzettel\",\n               descriptor: \"Loving church-member\",\n               location: \"Bergen\",\n               county: \"Bergen\",\n               age: 82\n           },\n           {\n               id: 5,\n               season: \"opening\",\n               name: \"Elizabeth Fulop\",\n               descriptor: \"Strong grandmother\",\n               location: \"Bloomfield\",\n               county: \"Essex\",\n               age: 94\n           },\n           {\n               id: 6,\n               season: \"opening\",\n               name: \"June Davis\",\n               descriptor: \"Entrepreneur \",\n               location: \"Buena Vista\",\n               county: \"Atlantic\",\n               age: 76\n           },\n           {\n               id: 7,\n               season: \"opening\",\n               name: \"Ruth Reeder\",\n               descriptor: \"Chuch Mom\",\n               location: \"Ship Bottom\",\n               county: \"Ocean\",\n               age: 96\n           },\n\n           {\n               id: 8,\n               season: \"opening\",\n               name: \"Ralph Amato\",\n               descriptor: \"Army Corporal ?\",\n               location: \"Parsippany\",\n               county: \"Morris\",\n               age: 91\n           },\n           {\n               id: 9,\n               season: \"opening\",\n               name: \"Hazel Mijares\",\n               descriptor: \"Nurse\",\n               location: \"Jersey City\",\n               county: \"Hudson\",\n               age: 66\n           },\n           {\n               id: 10,\n               season: \"opening\",\n               name: \"Asha Pritam Badlani\",\n               descriptor: \"Storyteller & home chef\",\n               location: \"Hasbrouck Heights\",\n               county: \"Bergen\",\n               age: 65\n           },\n           {\n               id: 11,\n               season: \"spring ’20\",\n               name: \"Barbara Hyland\",\n               descriptor: \"Race-car fan\",\n               location: \"Flemington\",\n               county: \"Hunterton\",\n               age: 69\n           },\n           {\n               id: 12,\n               season: \"spring ’20\",\n               name: \"Ashraf Sheikh\",\n               descriptor: \"Family man\",\n               location: \"Hopatcong\",\n               county: \"Sussex\",\n               age: 73\n           },\n           {\n               id: 13,\n               season: \"spring ’20\",\n               name: \"Julius Sabo\",\n               descriptor: \"Drummer & Guitarist\",\n               location: \"Hamilton\",\n               county: \"Mercer\",\n               age: 59\n           },\n           {\n               id: 14,\n               season: \"summer ’20\",\n               name: \"Zlatko Kesic\",\n               descriptor: \"Motorcyclist\",\n               location: \"West Orange\",\n               county: \"Essex\",\n               age: 62\n           },\n           {\n               id: 15,\n               season: \"summer ’20\",\n               name: \"Josef Schmidt\",\n               descriptor: \"Construction company operator\",\n               location: \"Clifton\",\n               county: \"Passaic\",\n               age: 72\n           },\n           {\n               id: 16,\n               season: \"summer ’20\",\n               name: \"Irving Callender\",\n               descriptor: \"Detective\",\n               location: \"Newark\",\n               county: \"Essex\",\n               age: 43\n           },\n           {\n               id: 17,\n               season: \"fall ’20\",\n               name: \"Katharine Lee Diller\",\n               descriptor: \"Elvis-lover\",\n               location: \"Lower Township\",\n               county: \"Cape May\",\n               age: 62\n           },\n           {\n               id: 18,\n               season: \"fall ’20\",\n               name: \"Harold Louis Eisen\",\n               descriptor: \"Community theatre actor\",\n               location: \"Manalapan \",\n               county: \"Monmouth\",\n               age: 83\n           },\n           {\n               id: 19,\n               season: \"fall ’20\",\n               name: \"Steven Alfred Emanuele\",\n               descriptor: \"Bar manager\",\n               location: \"\",\n               county: \"Ocean\",\n               age: 67\n           },\n           {\n               id: 20,\n               season: \"winter ’20 - ’21\",\n               name: \"MaryAnn Morris\",\n               descriptor: \"Diehard Mets fan\",\n               location: \"Edison\",\n               county: \"Middlesex\",\n               age: 80\n           },\n           {\n               id: 21,\n               season: \"winter ’20 - ’21\",\n               name: \"Ruth Allen\",\n               descriptor: \"Sweet grandmother\",\n               location: \"Riverside\",\n               county: \"Burlington\",\n               age: 89\n           },\n           {\n               id: 22,\n               season: \"winter ’20 - ’21\",\n               name: \"Candida Palmieri\",\n               descriptor: \"World traveler\",\n               location: \"Audubon\",\n               county: \"Camden\",\n               age: 71\n           },\n           {\n               id: 23,\n               season: \"spring ’21\",\n               name: \"David Bohan\",\n               descriptor: \"Shop teacher\",\n               location: \"Long Beach Island\",\n               county: \"Ocean\",\n               age: 74\n           },\n           {\n               id: 24,\n               season: \"spring ’21\",\n               name: \"Jordan Tassy\",\n               descriptor: \"Community volunteer\",\n               location: \"Montclair\",\n               county: \"Essex\",\n               age: 22\n           },\n           {\n               id: 25,\n               season: \"spring ’21\",\n               name: \"Dr. Rajendra Kapila\",\n               descriptor: \"Doctor\",\n               location: \"South Orange\",\n               county: \"Essex\",\n               age: 81\n           },\n           {\n               id: 26,\n               season: \"summer ’21\",\n               name: \"Abel Sanchez-Casas\",\n               descriptor: \"Health care worker\",\n               location: \"Newton\",\n               county: \"Sussex\",\n               age: 21\n           },\n           {\n               id: 27,\n               season: \"summer ’21\",\n               name: \"Vincent Intiso\",\n               descriptor: \"Firefighter\",\n               location: \"Succasunna\",\n               county: \"Morris\",\n               age: 57\n           },\n           {\n               id: 28,\n               season: \"summer ’21\",\n               name: \"Peter Shellhamer\",\n               descriptor: \"Police officer\",\n               location: \"Oak Ridge\",\n               county: \"Passaic\",\n               age: 59\n           },\n           {\n               id: 29,\n               season: \"fall ’21\",\n               name: \"Jeff Horohonich\",\n               descriptor: \"High school coach\",\n               location: \"Saddle Brook\",\n               county: \"Passaic\",\n               age: 60\n           },\n           {\n               id: 30,\n               season: \"fall ’21\",\n               name: \"Amelia Perry\",\n               descriptor: \"Student\",\n               location: \"Haddon\",\n               county: \"Camden\",\n               age: 12\n           },\n           {\n               id: 31,\n               season: \"fall ’21\",\n               name: \"David Formeza\",\n               descriptor: \"Police officer\",\n               location: \"Perth Amboy\",\n               county: \"Middlesex\",\n               age: 45\n           },\n           {\n               id: 32,\n               season: \"winter ’21-’22\",\n               name: \"Anthony “Tom” Tanski\",\n               descriptor: \"Construction\",\n               location: \"Hazlet\",\n               county: \"Monmouth\",\n               age: 76\n           },\n           {\n               id: 33,\n               season: \"winter ’21-’22\",\n               name: \"Susan Tanski\",\n               descriptor: \"Nurse\",\n               location: \"Hazlet\",\n               county: \"Monmouth\",\n               age: 73\n           },\n           {\n               id: 34,\n               season: \"winter ’21-’22\",\n               name: \"Matthew Horton\",\n               descriptor: \"Ocean County Sheriff’s officer\",\n               location: \"Berkeley\",\n               county: \"Ocean\",\n               age: 40\n           }\n       ];","import React, { useRef } from \"react\";\nimport { useFrame, useLoader } from \"@react-three/fiber\";\nimport { RainShader } from \"./RainShader\";\nimport { TextureLoader } from \"three/src/loaders/TextureLoader\";\nimport { stepPoint } from \"./data.js\";\nimport { AdditiveBlending } from \"three\";\nimport { death_to_date, newDeathsPerWeek } from \"./data\";\nimport pointPosByCounty from '../data/pointByCountyPos_random.json';\nfunction Points(props) {\n    // This reference will give us direct access to the THREE.Mesh object\n    let { step, uNowTime, COUNT, startTime, randomNumArr, isMobile } = props;\n    // console.log(\"Points COUNT: \", COUNT);\n    const stepNum = !stepPoint[step] ? 0.0 : stepPoint[step][\"num\"];\n    const highlightArr =\n        step && step > 2\n            ? [\n                  stepPoint[step][\"num\"] - 1,\n                  stepPoint[step][\"num\"] - 2,\n                  stepPoint[step][\"num\"] - 3\n              ]\n            : [];\n\n    const lastStepNum = !step || step < 1 ? 0.0 : stepPoint[step - 1][\"num\"];\n\n    console.log(\n        \"points stepNum, lastStepNum\",\n        step,\n        stepNum,\n        lastStepNum,\n        highlightArr\n    ); // 1,1,0\n    const mesh = useRef();\n    const mat = useRef();\n    // Set up state for the hovered and active state\n    let hoverIdx = 0;\n    const [pointTexture] = useLoader(TextureLoader, [\n        \"./assets/images/raindrop_img.png\"\n    ]);\n\n    // Subscribe this component to the render-loop, rotate the mesh every frame\n    useFrame((state, delta) => {\n        const rainDrop = mesh.current;\n        const material = mat.current;\n        if (rainDrop) {\n            // update uTime, uOldTime\n            // rainDrop.rotation.y += 0.0001;\n            material.uniforms.uTime.value = state.clock.elapsedTime;\n            material.uniforms.uOldTime.value = state.clock.oldTime;\n            material.uniforms.uHoverIdx.value = hoverIdx;\n            rainDrop.geometry.attributes.position.needsUpdate = true;\n            rainDrop.geometry.computeBoundingBox();\n            // uTime: time since the page is loaded the first time;\n            // uOldTime-startTime: recount on ever step\n            // console.log(\"material.uniforms.uTime\", material.uniforms.uTime, material.uniforms.uStartTime, material.uniforms.uOldTime);\n        }\n    });\n\n    // Return the view, these are regular Threejs elements expressed in JSX\n    const vertices = [],\n        aSpeed = [],\n        aRandom = [];\n    vertices.push(0.0, 100.0, 0.0); // vec3( 400.* (aRandom.x-.5), -50.-200.*aRandom.y, 0.);\n    aSpeed.push(0.0001, 0, 0); // index, rank, newDeathsPerWeek\n    aRandom.push(0.5, 0.4);\n\n    //TODO: use React.useMemo?\n    for (let i = 1; i < COUNT; i++) {\n        let R = i < 11 ? 200 : 400;\n        // const x = (Math.random() * 100 - 50) * Math.sin(Math.random());\n        // const y = Math.random() * 400 - 200;\n        // const z = (Math.random() * 50 - 25) * Math.cos(Math.random());\n        let t = 2 * Math.PI * randomNumArr[i];\n        let u =\n            randomNumArr[i + Math.round(COUNT / 500.0) - 1] +\n            randomNumArr[i + Math.round(COUNT / 250.0) - 1];\n        let r = u > 1 ? (2 - u) * R : u * R;\n\n        const x = r * Math.cos(t);\n        const y = r * Math.sin(t);\n        const z = randomNumArr[i] * 200 - 100;\n\n        let whichWeek = getRank(i, death_to_date);\n\n        vertices.push(x, y, z);\n        aSpeed.push(i, whichWeek, newDeathsPerWeek[whichWeek]);\n        aRandom.push(\n            i < 11 ? getOneThirdPosX(i) : randomNumArr[i],\n            i < 11\n                ? getOneThirdPosY(i)\n                : randomNumArr[i + Math.floor(COUNT / 500)]\n        );\n    }\n\n    if (pointPosByCounty.length!==vertices.length){\n        console.log(\n            \"aEndPosition doesn't have enough data. update ../data/pointByCountyPos_random.json file. \",\n            vertices.length,\n            pointPosByCounty.length\n        );\n\n\n    }\n\n\n    function getOneThirdPosX(i) {\n        if (i % 3 === 1) { // vec3 endPoint = vec3( 400.* (aRandom.x-.5), -50. - 200.*aRandom.y, 0.);\n            // -220, -40, 120\n            return -0.05;\n        } else if (i % 3 == 2) {\n            return 0.4;\n        } else if (i % 3 == 0) {\n            return 0.8;\n        }\n    }\n    function getOneThirdPosY(i) { // -50. - 200.*aRandom.y  (-50, -110, -190)\n        if (Math.floor((i - 1) / 3) === 0) {\n            return 0;\n        } else if (Math.floor((i - 1) / 3) === 1) {\n            return 0.35;\n        } else if (Math.floor((i - 1) / 3) === 2) {\n            return 0.75;\n        }\n    }\n    function getRank(idx, arr) {\n        let rank = 0;\n        for (let i = 0; i < arr.length - 1; i++) {\n            if (idx >= arr[i] && idx < arr[i + 1]) {\n                rank = arr.indexOf(arr[i + 1]);\n            }\n        }\n        return rank;\n    }\n\n    return (\n        <points ref={mesh}>\n            <bufferGeometry attach=\"geometry\" name=\"unclickable-point-geo\">\n                <bufferAttribute\n                    attachObject={[\"attributes\", \"position\"]}\n                    count={vertices.length / 3}\n                    // this renders the dots fine\n                    array={new Float32Array(vertices)}\n                    itemSize={3}\n                    onUpdate={self => {\n                        self.needsUpdate = true;\n                        self.verticesNeedUpdate = true;\n                    }}\n                />\n                <bufferAttribute\n                    attachObject={[\"attributes\", \"aEndPosition\"]}\n                    count={vertices.length / 3}\n                    // this renders the dots fine\n                    array={new Float32Array(pointPosByCounty)}\n                    itemSize={3}\n                    onUpdate={self => {\n                        self.needsUpdate = true;\n                        self.verticesNeedUpdate = true;\n                    }}\n                />\n                <bufferAttribute\n                    attachObject={[\"attributes\", \"aSpeed\"]}\n                    count={aSpeed.length / 3}\n                    array={new Float32Array(aSpeed)}\n                    itemSize={3}\n                />\n                <bufferAttribute\n                    attachObject={[\"attributes\", \"aRandom\"]}\n                    count={aRandom.length / 2}\n                    array={new Float32Array(aRandom)}\n                    itemSize={2}\n                />\n            </bufferGeometry>\n\n            <shaderMaterial\n                attach=\"material\"\n                transparent={true}\n                depthTest={false}\n                ref={mat}\n                args={[RainShader]}\n                blending={AdditiveBlending}\n                uniforms-uTime={{ value: 0 }}\n                uniforms-uOldTime={{ value: 0 }}\n                // uniforms-uNowTime={{ value: uNowTime }}\n                uniforms-uStartTime={{ value: startTime }}\n                uniforms-uHoverIdx={{ value: hoverIdx }}\n                uniforms-uLastHighlight={{\n                    value: !step || step < 1 ? 0.0 : stepPoint[step - 1][\"num\"]\n                }}\n                uniforms-uIsMobile={{value: (isMobile?1:0) }}\n                uniforms-uHighlight={{ value: stepNum }}\n                uniforms-uStep={{value: step}}\n            />\n        </points>\n    );\n}\n\nexport default React.memo(Points);\n","import React, { useRef } from \"react\";\nimport { DoubleSide } from \"three\";\nimport { useLoader, useFrame } from \"@react-three/fiber\";\nimport { TextureLoader } from \"three/src/loaders/TextureLoader\";\nfunction Cloud(props) {\n    // This reference will give us direct access to the THREE.Mesh object\n    const mesh = useRef();\n    // // Set up state for the hovered and active state\n    // const [hovered, setHover] = useState(false);\n    // const [active, setActive] = useState(false);\n    // // Subscribe this component to the render-loop, rotate the mesh every frame\n    useFrame((state, delta) =>\n        mesh.current ? (mesh.current.rotation.z -= 0.0008) : null\n    );\n    const [colorMap] = useLoader(TextureLoader, [\n        \"./assets/images/smoke-1.png\"\n    ]);\n\n    return (\n        <mesh {...props} ref={mesh}>\n            <planeBufferGeometry args={[600, 600]} />\n            <meshLambertMaterial\n                opacity={0.3}\n                side={DoubleSide}\n                transparent={true}\n                map={colorMap}\n                depthTest={false}\n            />\n        </mesh>\n    );\n}\n\nexport default Cloud;\n","import React, { useRef, memo } from \"react\";\nimport { useFrame } from \"@react-three/fiber\";\n\nfunction FlashLight() {\n    // This reference will give us direct access to the THREE.Mesh object\n    const Light = useRef();\n    // // Set up state for the hovered and active state\n    useFrame((state, delta) =>{\n        let flash = Light.current;\n        if (Math.random() > 0.96 || flash.power > 100) {\n            if (flash.power < 100)\n                flash.position.set(\n                    (Math.random() * 200 -100),\n                    100 + Math.random() * 100,\n                    -100\n                );\n            flash.power = 50 + Math.random() * 500;\n        }\n    });\n\n\n    return (\n        <pointLight\n            ref={Light}\n            args={[0x062d89, 30, 500, 1.7]}\n            position={[0, 90, -90]}\n        />\n    );\n}\n\nexport default memo(FlashLight);\n","import React from \"react\";\nimport { useLoader } from \"@react-three/fiber\";\nimport { TextureLoader } from \"three/src/loaders/TextureLoader\";\nimport { DoubleSide } from \"three\";\nfunction Map(props) {\n    const {opacity, scale} = props;\n    // Draw map here: https://observablehq.com/d/70bfdb7d8450275d\n    const [colorMap] = useLoader(TextureLoader, [\n        \"./assets/images/nj_map4.png\"\n    ]);\n\n    return (\n        <mesh position={[0, -100, 0]} rotation={[-1.57, 0, 0]} scale={scale}>\n            <planeBufferGeometry args={[686, 1407]} />\n            <meshBasicMaterial\n                opacity={opacity}\n                // side={DoubleSide}\n                transparent={true}\n                map={colorMap}\n                depthTest={false}\n            />\n        </mesh>\n    );\n}\n\nexport default Map;\n","// import { Box} from \"@react-three/drei\";\nimport React, {memo, useEffect, useState} from \"react\";\nimport { useThree, useFrame } from \"@react-three/fiber\";\nimport TWEEN from \"@tweenjs/tween.js\";\nimport * as THREE from \"three\";\nimport worldToScreen from './worldToScreen';\n\nconst UpdateCamera = props => {\n    const { step, isMobile } = props;\n    console.log('updateCamera-step: ', step)\n\n    let theta = 0;\n    const { camera, gl, scene } = useThree();\n    camera.fov = isMobile? 75: 60;\n    camera.near = 0.1;\n    camera.far = 2000;\n    \n    let allTooltips = document.querySelectorAll(\".tooltip_ctn\");\n    allTooltips &&\n        allTooltips.forEach(t => {\n            let posX = +t.dataset.posx;\n            let posY = +t.dataset.posy;\n            let newPos = worldToScreen(\n                new THREE.Vector3(posX, posY, 0),\n                gl,\n                camera\n            );\n            t.style.left = `calc(${(newPos.x * 100).toFixed(2)}% + 10px )`;\n            t.style.top = `calc(${(newPos.y * 100).toFixed(2)}% - 10px )`;\n        });\n        // {x: 0.498, y: 0.225, z: 0}\n    // console.log('world2Screen: ', worldToScreen(new THREE.Vector3(0, 80, 0), gl, camera));\n\n    let [cameraInitPos, setCameraInitPos] = useState({\n        x: 0,\n        y: isMobile ? -100 : 0,\n        z: isMobile ? 720 : 500\n    });\n\n    useEffect(()=>{\n        setCameraInitPos(cameraInitPos => {\n            return { x: 0, y: isMobile ? -100 : 0, z: isMobile ? 720 : 500 };\n        })\n    }, [isMobile])\n\n    let targetBox = scene.getObjectByName(\"cameraTarget\");\n    let targetPos = new THREE.Vector3(0, 0, 0);\n    let tPos = targetBox ? targetBox.position : new THREE.Vector3(0, 0, 0);\n    camera.lookAt(tPos);\n\n    if (step === 0 ) {\n        // tweenCamera(camera, cameraInitPos);\n    } else if (step === 11) {\n        tweenCamera(camera, { x: 0, y: 30, z: 250 });\n    } else {\n        // camTarget = new THREE.Vector3(0, 50, 0);\n        // console.log(\"_______ change camera: \", {\n        //     x: 0,\n        //     y: 0,\n        //     z: isMobile ? 1200 : 500\n        // });\n        tweenCamera(camera, cameraInitPos);\n    }\n\n    // useEffect(()=>{\n    //     if(step===11 && (clickedIdx===0 || clickedIdx>0) ){\n    //         tweenCamera(camera, { x: 0, y: 30, z: 250 }, targetBox, targetPos);\n    //     }\n    // }, [clickedIdx])\n\n    camera.updateProjectionMatrix();\n\n    useFrame(state => {\n        TWEEN.update();\n        camera.lookAt(targetPos);\n\n        if (+step === 0  || +step === 11) {\n            theta += 0.03;\n            camera.position.x = 252 * Math.sin(THREE.MathUtils.degToRad(theta));\n            camera.position.z = 252 * Math.cos(THREE.MathUtils.degToRad(theta));\n        }\n    });\n\n    return null;\n};\n\nfunction tweenCamera(camera, cameraPos) {    \n    let pos = camera.position;\n    // let tPos = new THREE.Vector3(0, 0, 0);\n\n    new TWEEN.Tween(pos)\n        .to({ x: cameraPos.x, y: cameraPos.y, z: cameraPos.z }, 1000)\n        .easing(TWEEN.Easing.Quadratic.Out)\n        .onUpdate(function() {})\n        .start();\n\n    // new TWEEN.Tween(tPos)\n    //     .to({ x: targetPos.x, y: targetPos.y, z: targetPos.z }, 1000)\n    //     .easing(TWEEN.Easing.Quadratic.Out)\n    //     .onUpdate(function() {\n    //         // console.log('tweening camera, xyz: ',pos.x, pos.y, pos.z )\n    //     })\n    //     .start();\n}\n\nfunction isEqual(prev, next){\n    return prev.step===next.step && prev.isMobile===next.isMobile\n}\n\nexport default memo(UpdateCamera, isEqual);\n","export default function worldToScreen(vector, renderer, camera) {\n    // var vector = new THREE.Vector3();\n    var canvas = renderer.domElement;\n    // map to normalized device coordinate (NDC) space\n    vector.project(camera);\n    // map to 2D screen space\n    vector.x = (vector.x + 1) / 2;\n    vector.y = (-vector.y + 1) / 2;\n    vector.z = 0;\n    return vector\n}\n","const RainShaderClickable = {\n    vertexShader: `\n    #define PI 3.14159265359;\n    uniform float uHoverIdx;\n    attribute vec3 aSpeed;\n    // uniform float uTime;\n\n    void main() {\n        // float timer = smoothstep(0.0, 1.0, uTime);\n        // vec3 newPos = mix(vec3(0.), position, timer);\n        vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n        gl_Position = projectionMatrix * mvPosition;\n        gl_PointSize =  1800.0 / -mvPosition.z + 20. + (aSpeed.x==uHoverIdx? 120.: 20.);\n    }\n  `,\n    fragmentShader: `\n    uniform float uTime;\n    uniform float uHoverIdx;\n    float rand(vec2 co){\n      return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n    }\n    void main() {\n      //0, 119, 182\n        // vec3 color = vec3(0., 0.467, 0.714);\n        vec3 color = vec3(rand(gl_PointCoord.xy*2.), 0.66, 0.94 +.5* rand(gl_PointCoord.xy*3.0) );\n        vec2 toCenter = (gl_PointCoord.xy - 0.5)* 8.;\n        float len = length(toCenter);\n        float a = 1.0 - len;\n        float opacityWeight = (uHoverIdx>0.)? 1.0: step(0.5, uTime) ;\n        // float timer = smoothstep(2.0, 4.0, uTime);\n        gl_FragColor = vec4(color, a* opacityWeight );\n    }\n  `\n};\n\nexport { RainShaderClickable };\n","import React, { useRef, useEffect, useMemo, memo } from \"react\";\nimport { useFrame, useLoader } from \"@react-three/fiber\";\nimport * as THREE from \"three\";\nimport { death_to_date, newDeathsPerWeek } from \"./data\";\nimport { RainShaderClickable } from \"./RainShaderClickable\";\nimport { select } from \"d3-selection\";\n\nfunction PointsClickable(props) {\n    // This reference will give us direct access to the THREE.Mesh object\n\n    let { clickedIdx, deathData, pointByCountyPosWithName } = props;\n\n    const nowTime = performance.now();\n    const allNamesData = deathData[\"names\"].filter(t=> t.county);\n\n    let COUNT = allNamesData.length;\n    // console.log(\"allNamesData\", allNamesData);\n\n    let hoverIdx = +clickedIdx;\n\n    // console.log(\"!!!!!!!!PointsClickable: \", clickedIdx);\n\n    const mesh = useRef(null);\n    const mat = useRef();\n    let timer;\n\n\n    useFrame((state, delta) => {\n        const rainDrop = mesh.current;\n        const material = mat.current;\n        \n        if (rainDrop ) {\n            material.uniforms.uTime.value = state.clock.elapsedTime-nowTime*0.001;\n            material.uniforms.uHoverIdx.value = hoverIdx;\n            const pos = rainDrop.geometry.attributes.position;\n            // change points position\n            pos.needsUpdate = true;\n\n            for (let i = 0; i < COUNT; i++) {        \n                if ( clickedIdx && (+clickedIdx) == i ) {\n                // if ( (clickedIdx=='0') || (clickedIdx && +clickedIdx === i) ) {\n                    let targetPos = [0, 90, -10];\n                    pos[\"array\"][ i * 3] = 0;\n                    (pos[\"array\"][i * 3 + 1] <= targetPos[1]) && (pos[\"array\"][i * 3 + 1] += 3);\n                    pos[\"array\"][i * 3 + 2] = -10;\n                } \n            }\n        }\n    });\n\n    // when searched a name, this will be called to show tooltip\n    let tooltipTimer;\n    useEffect(() => {\n        if (!clickedIdx && clickedIdx !== 0) return null;\n        clearTimeout(tooltipTimer);\n        tooltipTimer = setTimeout(() => {\n            let tooltipCtn = select(\".tooltip_ctn__100\");\n            tooltipCtn.classed(\"active\", true);\n            tooltipCtn.classed(\"newActive\", true);\n            const clickedData = deathData[\"names\"][clickedIdx];\n\n            tooltipCtn.style(\"top\", \"150px\").style(\"left\", \"50vw\");\n            tooltipCtn\n                .select(\".tooltipHeader\")\n                .html(clickedData[\"name_display\"]);\n\n            tooltipCtn\n                .select(\".tooltipLoc\")\n                .html(\n                    `${(clickedData[\"age\"] ? clickedData[\"age\"] + \", \" : \"\") +\n                        (clickedData[\"county\"]\n                            ? clickedData[\"county\"] + \" County\"\n                            : \"\")}`\n                );\n\n            tooltipCtn\n                .select(\".tooltipURL\")\n                .html(\n                    `${clickedData[\"obit_link\"]? `<a target='_blank' href=${clickedData[\"obit_link\"]}>Read the orbituary</a>`: ''}`\n                );\n        }, 1000);\n\n        return () => {\n            clearTimeout(tooltipTimer);\n        };\n    }, [clickedIdx]);\n\n    // Return the view, these are regular Threejs elements expressed in JSX\n    const vertices = [],\n          sizes=[],\n          aSpeed = [];\n        // aRandom = [];\n\n    // vertices.push(0.0, 100.0, 0.0);\n    // aSpeed.push(0.001, 0, 0); // index, rank, newDeathsPerWeek\n    // aRandom.push(0.5, 0.4);\n\n    for (let i = 0; i < COUNT; i++) {\n        let whichWeek = getRank(i, death_to_date);\n        vertices.push(\n            pointByCountyPosWithName[i * 3],\n            pointByCountyPosWithName[i * 3 + 1],\n            pointByCountyPosWithName[i * 3 + 2]\n        );\n        // sizes.push(15, 15, 15);\n        aSpeed.push(i, whichWeek, newDeathsPerWeek[whichWeek]);\n    }\n\n    function getRank(idx, arr) {\n        let rank = 0;\n        for (let i = 0; i < arr.length - 1; i++) {\n            if (idx >= arr[i] && idx < arr[i + 1]) {\n                rank = arr.indexOf(arr[i + 1]);\n            }\n        }\n        return rank;\n    }\n    function onPointerOver(event) {\n        hoverIdx = event.index;\n        // console.log(\"_____ clickable onPointerOver: \", event.index, event);\n        let tooltipCtn = select(\".tooltip_ctn__100\");\n\n        let namesData = deathData[\"names\"];\n        if (event.index > -1 && namesData[event.index]) {\n            document.querySelector(\"canvas\").style.pointer = \"cursor\";\n            // play audio\n            const audioFile = document.querySelector(\n                `#chime-${(event.index % 12) + 1}`\n            );\n            audioFile.currentTime = 0;\n            audioFile.volume = 0.3 + Math.random() * 0.6;\n            audioFile.play();\n            // turn on tooltip\n            tooltipCtn.classed(\"active\", true);\n            tooltipCtn.classed(\"newActive\", true);\n            clearTimeout(timer);\n            timer = setTimeout(() => {\n                tooltipCtn.classed(\"newActive\", false);\n            }, 4000);\n            const hovered = namesData[event.index];\n\n            const tooltipCtn2 = document.querySelector(\".tooltip_ctn__100\");\n            tooltipCtn2.style.top = event.pageY - 80 + \"px\";\n            tooltipCtn2.style.left = event.pageX - 20 + \"px\";\n\n            tooltipCtn.select(\".tooltipHeader\").html(hovered[\"name_display\"]);\n\n            tooltipCtn\n                .select(\".tooltipLoc\")\n                .html(\n                    `${(hovered[\"age\"] ? hovered[\"age\"] + \", \" : \"\") +\n                        (hovered[\"county\"]\n                            ? hovered[\"county\"] + \" County\"\n                            : \"\")}`\n                );\n\n            tooltipCtn\n                .select(\".tooltipURL\")\n                .html(\n                    `${\n                        hovered[\"obit_link\"]\n                            ? `<a target='_blank' href=${hovered[\"obit_link\"]}>Read the orbituary</a>`\n                            : \"\"\n                    }`\n                );\n        }\n    }\n    function onPointerOut(event) {\n        document.querySelector(\"canvas\").style.pointer = \"auto\";\n        return;\n    }\n    function onDoubleClick(event) {\n        if (window.innerWidth >= 732) {\n            let data = deathData[\"names\"][event.index];\n            let url = data ? data[\"obit_link\"] : \"https://lovedandlostnj.com/\";\n            window.open(url, \"_blank\");\n        }\n    }\n\n    return (\n        <points\n            ref={mesh}\n            // onDoubleClick={onDoubleClick}\n            onPointerOver={onPointerOver}\n            onPointerOut={onPointerOut}\n        >\n            <bufferGeometry attach=\"geometry\" name=\"clickable-point-geo\">\n                <bufferAttribute\n                    name=\"position\"\n                    attachObject={[\"attributes\", \"position\"]}\n                    count={vertices.length / 3}\n                    array={new Float32Array(vertices)}\n                    itemSize={3}\n                    onUpdate={self => {\n                        self.needsUpdate = true;\n                        self.verticesNeedUpdate = true;\n                    }}\n                />\n                {/* <bufferAttribute\n                    name=\"size\"\n                    attachObject={[\"attributes\", \"size\"]}\n                    count={vertices.length / 3}\n                    array={new Float32Array(sizes)}\n                    itemSize={3}\n                /> */}\n                <bufferAttribute\n                    attachObject={[\"attributes\", \"aSpeed\"]}\n                    count={aSpeed.length / 3}\n                    array={new Float32Array(aSpeed)}\n                    itemSize={3}\n                />\n            </bufferGeometry>\n\n            <shaderMaterial\n                attach=\"material\"\n                transparent={true}\n                depthTest={false}\n                side={THREE.DoubleSide}\n                ref={mat}\n                args={[RainShaderClickable]}\n                blending={THREE.AdditiveBlending}\n                uniforms-uHoverIdx={{ value: hoverIdx }}\n                uniforms-uTime={{ value: 0.0 }}\n            />\n        </points>\n    );\n}\n\nfunction isEqual(prev, next){\n    return prev.clickedIdx === next.clickedIdx\n}\nexport default memo(PointsClickable, isEqual);\n","// import { Box} from \"@react-three/drei\";\nimport { Line, Text, Plane } from \"@react-three/drei\";\n// import { sRGBEncoding } from \"three\";\nimport * as THREE from 'three';\nimport React, { Suspense, useRef, useEffect } from \"react\";\nimport { Canvas, useThree, useFrame } from \"@react-three/fiber\";\nimport Points from \"./Points\";\nimport Cloud from \"./Cloud\";\nimport FlashLight from \"./FlashLight\";\nimport {dateArr} from './data.js';\n// import { FlyControls } from \"three/examples/jsm/controls/FlyControls\";\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls\";\nimport Map from './Map'\n\n// import {\n//     EffectComposer,\n//     BlendMode,\n//     DepthOfField,\n//     Bloom,\n//     Noise,\n//     Vignette\n// } from \"@react-three/postprocessing\";\n\nimport { GizmoHelper, GizmoViewport } from \"@react-three/drei\";\n// https://docs.pmnd.rs/react-three-fiber/API/objects\nimport UpdateCamera from './UpdateCamera';\nimport PointsClickable from './PointsClickable';\n\n\nconst CameraController = (props) => {\n    const { camera, gl } = useThree();\n    // gl.format = RGBAformat;\n    useEffect(() => {\n        const controls = new OrbitControls(camera, gl.domElement);\n        controls.minDistance = 20;\n        controls.maxDistance = 1000;\n        return () => {\n            controls.dispose();\n        };\n    }, [camera, gl]);\n    \n\n    return null;\n};\n\nfunction Scene(props){    \n    const { step, COUNT, randomNumArr, startTime, clickedIdx, deathData, pointByCountyPosWithName, isMobile, width } = props; // step\n\n    return (\n        <Canvas\n            camera={{ far: 1000, near: 0.1 }}\n            dpr={Math.min(1.5, window.devicePixelRatio)}\n            gl={{\n                format: THREE.RGBAFormat,\n                outputEncoding: THREE.sRGBEncoding\n            }}\n        >\n            <mesh name={\"cameraTarget\"} visible={false} position={[0, 0, 0]}>\n                <boxGeometry args={[1, 1, 1]} />\n                <meshBasicMaterial color=\"black\" />\n            </mesh>\n            <UpdateCamera step={step} isMobile={isMobile} />\n            <FlashLight />\n            <ambientLight color=\"#555555\" />\n            {step > 10 && <CameraController />}\n\n            {step < 11 &&\n                [1, 3, 4, 5, 6, 7, 8, 9, 10, 11].map((t, i) => {\n                    if (step >= t) {\n                        return (\n                            <Text\n                                key={`axis-label-text-${t}`}\n                                color=\"#e2e3e4\"\n                                fontSize={10}\n                                anchorX={\n                                    250 -\n                                    60 * i -\n                                    (isMobile && i === 0 ? 14 : 0)\n                                }\n                                anchorY={255 + (isMobile ? 85 : 0)}\n                            >\n                                {dateArr[i]}\n                            </Text>\n                        );\n                    }\n                    return null;\n                })}\n\n            <Suspense fallback={null}>\n                <Points\n                    step={step}\n                    uNowTime={performance.now()}\n                    COUNT={COUNT}\n                    randomNumArr={randomNumArr}\n                    startTime={startTime}\n                    isMobile={isMobile}\n                />\n                { step > 10 && \n                    <Map\n                        opacity={0.4}\n                        scale={[1, 1, 1]}\n                    />\n                }\n\n                <Cloud\n                    position={[0, 225, -200]}\n                    rotation={[1.26, -0.12, 250]}\n                />\n                <Cloud\n                    position={[220, 200, -100]}\n                    rotation={[1.16, -0.2, 250]}\n                />\n                <Cloud\n                    position={[-220, 210, -50]}\n                    rotation={[1.46, 0.1, 220]}\n                />\n                {\n                step > 10 && \n                    <PointsClickable\n                        // startTime={startTime}\n                        clickedIdx={clickedIdx}\n                        deathData={deathData}\n                        pointByCountyPosWithName={pointByCountyPosWithName}\n                    />\n                }\n            </Suspense>\n        </Canvas>\n    );\n}\n\n\nexport default Scene;\n","export default function createMarkup(htmlContent){\n    return { __html: htmlContent };\n}","import React from \"react\";\nimport createMarkup from \"./createMarkup\";\nfunction HeadContainer(prop) {\n    const { onClickFn, currentStepIndex, hed, dek, byline } = prop;\n    return (\n        <div className={`head_ctn ${!currentStepIndex ? \"active\" : \"\"}`}>\n            <h1\n                className=\"headline whiteTextShadow\"\n                dangerouslySetInnerHTML={createMarkup(hed)}\n            ></h1>\n            <p className=\"dek whiteTextShadow\">{dek}</p>\n            <p className=\"byline whiteTextShadow\">{byline}</p>\n            {/* <h5>Experience with sound</h5> */}\n            <div className=\"intro_buttonCtn\">\n                <button\n                    className=\"intro_button\"\n                    id=\"start_btn\"\n                    onClick={onClickFn}\n                >\n                    <span className=\"soundIcon\">\n                        <img src=\"./assets/images/feather-volume-2.svg\" />\n                    </span>\n                    Experience with sound\n                </button>\n            </div>\n        </div>\n    );\n}\n\nexport default HeadContainer;\n","import React, {useRef, useEffect, useState} from \"react\";\nimport { animationTime } from \"./data.js\";\nimport {select} from 'd3-selection';\nimport { transition } from 'd3-transition';\nimport {easeLinear} from 'd3-ease';\n\nfunction SoundControl(props) {\n    const { step, onSouncControlClick, audioEnabled } = props;\n    const circleRef = useRef();\n    const [inHover, setHover] = useState(false);\n\n    useEffect(()=>{\n        const aTime = animationTime[step];\n        const cur_Circle = circleRef.current;\n        if(step==null) return\n        // change the stroke\n        select(cur_Circle)\n            .attr(\"stroke-dashoffset\", -120)\n            .transition()\n            .duration(aTime * 1000 - 150)\n            .ease(easeLinear)\n            // make the duration 50ms less, to leave time for it to finish\n            // otherwise the second would play before the first ends, which cancel out the first\n            .attr(\"stroke-dashoffset\", 0);\n\n    }, [step])\n\n    return (\n        <div\n            className={`sound_control_ctn ${step == null ? \"\" : \"active\"}`}\n            onClick={onSouncControlClick}\n            onMouseEnter={() => setHover(true)}\n            onMouseLeave={() => setHover(false)}\n        >\n            <div className={`sound_control_tooltip ${inHover ? \"active\" : \"\"}`}>\n                {audioEnabled ? \"SOUND OFF\" : \"SOUND ON\"}\n            </div>\n            <svg\n                width=\"40\"\n                height=\"40\"\n                viewBox=\"0 0 40 40\"\n                fill=\"none\"\n                stroke=\"currentColor\"\n                strokeWidth=\"2\"\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                className=\"feather feather-volume-2\"\n            >\n                <circle\n                    cx=\"20\"\n                    cy=\"20\"\n                    r=\"19\"\n                    strokeDasharray=\"120\"\n                    strokeDashoffset=\"-120\"\n                    ref={circleRef}\n                    className=\"sound_control_circle\"\n                />\n                <circle cx=\"20\" cy=\"20\" r=\"19\" style={{ opacity: 0.3 }} />\n                <polygon\n                    transform=\"translate(8, 8)\"\n                    points=\"11 5 6 9 2 9 2 15 6 15 11 19 11 5\"\n                />\n                {audioEnabled && (\n                    <path\n                        transform=\"translate(8, 8)\"\n                        d=\"M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07\"\n                    />\n                )}\n                {!audioEnabled && (\n                    <g transform=\"translate(8, 8)\">\n                        <line x1=\"23\" y1=\"9\" x2=\"17\" y2=\"15\" />\n                        <line x1=\"17\" y1=\"9\" x2=\"23\" y2=\"15\" />\n                    </g>\n                )}\n            </svg>\n        </div>\n    );\n}\n\nexport default SoundControl;\n","import React, {memo} from \"react\";\nimport createMarkup from './createMarkup';\nfunction Step(props) {\n    let { data, stepIndex } = props;\n\n    return (\n        <div\n            className={`step__outer step__outer__${stepIndex}`}\n            data-step={stepIndex}\n            key={`step__outer__${stepIndex}`}\n        >\n            <div\n                className={`step__inner step__inner__${stepIndex}`}\n                key={`step__inner__${stepIndex}`}\n            >\n                { data['date'] && <h3\n                    key={`step__inner__hed__${stepIndex}`}\n                    className={`step__inner__hed`}\n                >\n                    {data[\"date\"]}\n                </h3>}\n                <p\n                    key={`step__inner__p__${stepIndex}`}\n                    dangerouslySetInnerHTML={createMarkup(data[\"text\"])}\n                ></p>\n            </div>\n        </div>\n    );\n}\n\nexport default memo(Step);\n","import React, {memo} from 'react';\n\nfunction Audio(props){\n    const { id, src, audioEnabled } = props;\n    return (\n        <audio\n            className=\"audio\"\n            muted ={!audioEnabled}\n            id={id}\n            key={id}\n            src={src}\n        />\n    );\n}\n\nexport default memo(Audio);","import React, { useEffect, useRef } from 'react'\nimport data from '../data/nj_parsed_weekly_death_data.json'\nimport NumberCount from './NumberCount';\n\nfunction DeathTollDiv(props){\n    const { currentStepIndex } = props;\n    const {stepPoint} = data;\n\n    let arr = stepPoint.map(t=> t.num)\n    const spanRef = useRef(null);\n\n    // console.log('deathtoll data: ', arr);\n    useEffect(()=>{\n        const curSpan = spanRef.current;\n        let curStepNum = !currentStepIndex? 0: arr[currentStepIndex];\n        let lastStepNum = !currentStepIndex ? 0 : arr[currentStepIndex - 1];\n        NumberCount(\n            \"deathToll_num\",\n            lastStepNum,\n            curStepNum,\n            currentStepIndex < 3 ? 3000 : 9500\n        );\n\n    }, [currentStepIndex]);\n\n    return (\n        <div className={`deathTollCtn ${currentStepIndex > 0 ? \"active\" : \"\"}`}>\n            <span className=\"deathToll_label\">Death toll</span>\n            <br />\n            <span\n                ref={spanRef}\n                className=\"deathToll_num\"\n                id=\"deathToll_num\"\n                data-target={arr[currentStepIndex]}\n            >\n                {!currentStepIndex? 0: arr[currentStepIndex-1]}\n            </span>\n        </div>\n    );\n}\n\nexport default DeathTollDiv","//https://stackoverflow.com/questions/16994662/count-animation-from-number-a-to-b\nexport default function NumberCount(id, start, end, duration) {\n    // assumes integer values for start and end\n\n    var obj = document.getElementById(id);\n    var range = end - start;\n    // no timer shorter than 50ms (not really visible any way)\n    var minTimer = 50;\n    // calc step time to show all interediate values\n    var stepTime = Math.abs(Math.floor(duration / range));\n\n    // never go below minTimer\n    stepTime = Math.max(stepTime, minTimer);\n\n    // get current time and calculate desired end time\n    var startTime = new Date().getTime();\n    var endTime = startTime + duration;\n    var timer;\n\n    function run() {\n        var now = new Date().getTime();\n        var remaining = Math.max((endTime - now) / duration, 0);\n        var value = Math.round(end - remaining * range);\n        obj.innerHTML = numberWithCommas(value);\n        if (value == end) {\n            clearInterval(timer);\n        }\n    }\n\n    timer = setInterval(run, stepTime);\n    run();\n}\n\nfunction numberWithCommas(x) {\n    return x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n}","import React, { useEffect, memo } from \"react\";\nimport {selectAll} from 'd3-selection';\nimport {chimeDelay} from './data';\nfunction Tooltip(props) {\n    let { data, stepIndex, currentStepIndex, pos, count } = props;\n    console.log('Tooltip currentStepIndex: ', currentStepIndex);\n    const {name, age, location, county } = data;\n    useEffect(() => {\n        selectAll(\".tooltip_ctn\").classed(\"active\", true);\n    }, [currentStepIndex]);\n    // currentStepIndex start: 1\n\n    return (\n        <div\n            className={`tooltip_ctn tooltip_ctn__${stepIndex}`}\n            data-step={stepIndex}\n            key={`tooltip_ctn__${stepIndex}`}\n            data-posx = {pos.x}\n            data-posy = {pos.y}\n            data-count = {count}\n            style={{ position: \"absolute\", top: \"-50%\", left: \"-50%\", color:'#ababab', animationDelay:`${chimeDelay[currentStepIndex-1][count] }s` }}\n        >\n            <p className=\"tooltip tooltipHeader\">{name}</p>\n            \n            <p className=\"tooltip tooltipLoc\" id={`tooltip__loc__${stepIndex}`}>\n                {`${age}, ${location? location: county+\" County\" }`}\n            </p>\n        </div>\n    );\n}\n\nexport default memo(Tooltip);\n","import React, { useRef, useState } from \"react\";\nimport {select, selectAll} from 'd3-selection'\n\nfunction SearchBar(props){\n    const { data, setClickedIdx } = props;\n    const {names} = data;\n    const parsedNames = names.map( (t,i) => {\n        t[\"idx\"] = i;\n        return t\n    });\n\n    const inputRef = useRef();\n    const listRef = useRef();\n    const parsedNames_sorted = parsedNames.sort(function(a, b) {\n        if (a.name_sort < b.name_sort) {\n            return -1;\n        }\n        if (a.name_sort > b.name_sort) {\n            return 1;\n        }\n        return 0;\n    });\n    let [searchingNames, setSearchingNames] = useState(parsedNames_sorted);\n\n    function onClick(event){\n        let currentList = listRef.current;\n        currentList.classList.add('show')\n        \n    }\n\n    function onItemClicked(event){\n        select(\".tooltip_ctn__100\").classed(\"newActive\", false);\n        const name = event.target.innerHTML;\n        const idx = event.target.dataset.idx;\n        inputRef.current.value = name;\n        select(\"#dropDownList_names\").classed('show', false);\n        setClickedIdx(clickedIdx => idx);\n        \n        // hide the .step__outer__9\n        select(\".step__outer__9\").classed('active', false);\n\n        const audioFile = document.querySelector(`#chime-${(idx % 12) + 1}`);\n        audioFile.currentTime = 0;\n        audioFile.volume = 0.3 + Math.random() * 0.6;\n        audioFile.play();\n    }\n\n    function onKeyUp(event){\n        // console.log('onKeyUp: ', event, event.target.value)\n        const val = event.target.value;\n        filterFunction(val);\n    }\n\n    function filterFunction(val) {\n        let filter = val.toUpperCase();\n        setSearchingNames((searchingNames)=>{\n            let filteredNames = parsedNames.filter(\n                t => (t.name_display +', '+ t.county).toUpperCase().indexOf(filter) > -1\n            );\n            return filteredNames.sort(function(a, b) {\n                if (a.name_sort < b.name_sort) {\n                    return -1;\n                }\n                if (a.name_sort > b.name_sort) {\n                    return 1;\n                }\n                return 0;\n            });\n        })\n        let a = document.getElementsByClassName(\".list-item\");\n        for (let i = 0; i < a.length; i++) {\n            if (a[i].innerHTML.toUpperCase().indexOf(filter) > -1) {\n                a[i].style.display = \"\";\n            } else {\n                a[i].style.display = \"none\";\n            }\n            a[0].style.display = \"\";\n        }\n    }\n\n    return (\n        <div className=\"search-bar-ctn\">\n            <h5>\n                <span className=\"desktopOnly\">\n                    Mouse over brighter dots<br />\n                    or search by name or county\n                </span>\n                <span className=\"mobileOnly\">Search by name or county</span>\n            </h5>\n            <input\n                ref={inputRef}\n                type=\"text\"\n                placeholder=\"Search...\"\n                id=\"search-bar-input\"\n                onClick={onClick}\n                onKeyUp={onKeyUp}\n                autoComplete=\"off\"\n            />\n            <div ref={listRef} className=\"dropDownList\" id=\"dropDownList_names\">\n                <div className=\"dropdown-content\">\n                    {searchingNames.map((t, i) => (\n                        <a\n                            className=\"list-item\"\n                            data-idx={t.idx}\n                            key={t.id}\n                            id={t.id}\n                            onClick={onItemClicked}\n                        >\n                            {t.name_display + \", \" + t.county}\n                        </a>\n                    ))}\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport default SearchBar","import React, { useRef, forwardRef } from \"react\";\nimport createMarkup from \"./createMarkup\";\n\nfunction CreditCard(props, ref){\n    const {data} = props;\n\n\n    function onClick(){\n        document.querySelector(\".credit-page\").classList.remove(\"active\");\n    }\n\n    return (\n        <div className=\"credit-page\" ref={ref}>\n            <div className=\"close-credit\" onClick={onClick}>✕</div>\n            {data.map( (t,i) => (\n                <p\n                    className=\"credit_line\"\n                    key={`credit_line_${i}`}\n                    dangerouslySetInnerHTML={createMarkup(t.value)}\n                ></p>\n            ))}\n        </div>\n    );  \n}\n\nexport default forwardRef(CreditCard);","import React, { useState, useEffect, useRef, useMemo, memo } from \"react\";\nimport Scene from \"./Scene\";\nimport HeadContainer from \"./headContainer.js\";\nimport SoundControl from \"./SoundControl\";\nimport Step from \"./Step.js\";\nimport Audio from './Audio';\nimport DeathTollDiv from './DeathTollDiv';\nimport Tooltip from './Tooltip';\nimport SearchBar from './SearchBar';\nimport CreditCard from \"./CreditCard\";\nimport seedrandom from \"seedrandom\";\nimport { isMobile } from \"react-device-detect\";\nimport { animationTime, audioData, allDeathToll, victimData, stepTooltipArr, tooltipPos } from \"./data.js\";\nimport njDeathData from '../data/covid_death_all_names_sorted.json';\nimport data from \"../data/copy.json\";\nimport pointByCountyPosWithName from \"../data/pointByCountyPos_random_with_name.json\";\n\nfunction MainCtn(props) {\n    const njCovidArr = njDeathData[\"names\"];\n    const {hed, dek, byline} = data;\n\n    const [currentStepIndex, setCurrentStepIndex] = useState(null);\n    const [startTime, setStartTime] = useState(performance.now())\n    let [clickedIdx, setClickedIdx] = useState();\n    // This callback fires when a Step hits the offset threshold. It receives the\n    // data prop of the step, which in this demo stores the index of the step.\n    let stepData = data.content.filter(t => t.type === \"step\");\n    let step = stepData[0].value;\n    const stepCtnRef = useRef(null);\n\n    const creditRef = useRef();\n    const COUNT = allDeathToll;\n    // console.log('allDeathToll', allDeathToll)\n    const [audioEnabled, setAudioEnabled] = useState(false);\n\n    useEffect(() => {\n        showStep();\n        setStartTime(performance.now());\n    }, [currentStepIndex]);\n\n    // check screensize\n     const [screenSize, getScreenSize] = useState({\n         width: window.innerWidth,\n         height: window.innerHeight\n     });\n     const setDimension = () => {\n         getScreenSize({\n             width: window.innerWidth,\n             height: window.innerHeight\n         });\n     };\n\n     useEffect(() => {\n         window.addEventListener(\"resize\", setDimension);\n\n         return () => {\n             window.removeEventListener(\"resize\", setDimension);\n         };\n     }, [screenSize]);\n\n\n    const randomNumArr = useMemo(() => {\n        function generatePRNG() {\n            const arr = [];\n            Array.apply(null, Array(50000)).map((t, i) => {\n                arr.push(seedrandom.alea(i)());\n            });\n            return arr;\n        }\n        return generatePRNG();\n    }, []);\n\n\n    let i = 1;\n    let timer;\n\n    function showStep() {\n        let stepCtn = stepCtnRef.current;\n        let { children } = stepCtn;\n        let ctnArr = [...children];\n\n        ctnArr.forEach((child, i) => {\n            if (i == currentStepIndex) {\n                child.classList.add(\"active\");\n            } else if (child.classList.contains(\"active\")) {\n                child.classList.remove(\"active\");\n            }\n        });\n    }\n\n    function onClickFn(prop) { // run the animation\n        document.querySelector(\".head_ctn\").classList.remove(\"active\");\n        setCurrentStepIndex(0);\n        \n        setAudioEnabled(true);\n        // run the animation\n        let idx = 0;\n        let timer;\n        loop();\n        function loop(){\n            if(idx==0){\n                document.querySelector('#introAudio').play();\n            } else if(idx==1){\n                document.querySelector(\"#mainAudio\").play();\n            } else if(idx==11){\n                const endAudio = document.querySelector(\"#endingDrone\");\n                endAudio.loop = true;\n                endAudio.play();\n            }\n            setCurrentStepIndex(idx);\n            timer = setTimeout(loop, animationTime[idx] * 1 * 1000);\n            idx++;\n            if (idx > animationTime.length) {\n                console.log('clearTimeOut')\n                clearTimeout(timer);\n                \n                setTimeout(t => {\n                    document.querySelector(\".step__outer__11\").classList.remove('active');\n                    document.querySelector(\".search-bar-ctn\").classList.add('active');\n                return\n                }, (isMobile?15: 25) * 1000);\n                \n                return\n            }\n        }\n\n    }\n\n    function onSouncControlClick(){\n        setAudioEnabled(!audioEnabled);\n    }\n\n    return (\n        <div className=\"main__ctn\">\n            <HeadContainer\n                onClickFn={onClickFn}\n                currentStepIndex={currentStepIndex}\n                hed={hed}\n                dek={dek}\n                byline={byline}\n            />\n            {audioData.map( (obj,i) => {\n                let { key, src } = obj;\n                return <Audio id={key} key={`audio_${key}_${i}`} src={src} audioEnabled={audioEnabled} />;\n            })}\n\n            <CreditCard data={data.credits} ref={creditRef} />\n            {\n                <div\n                    className={`tooltip_ctn tooltip_ctn__100`}\n                    data-step={100}\n                    key={`tooltip_ctn__${100}`}\n                    data-posx={-250.5}\n                    data-posy={200}\n                    style={{\n                        position: \"absolute\",\n                        top: \"-50%\",\n                        left: \"-50%\",\n                        color: \"#ababab\"\n                    }}\n                >\n                    <p className=\"tooltip tooltipHeader\"></p>\n                    <p\n                        className=\"tooltip tooltipLoc\"\n                        id={`tooltip__loc__${100}`}\n                    ></p>\n                    <p className=\"tooltip tooltipURL\" id={`tooltip__url__${100}`}></p>\n                </div>\n            }\n\n            {stepTooltipArr[currentStepIndex] &&\n                stepTooltipArr[currentStepIndex].length &&\n                stepTooltipArr[currentStepIndex].map((t, i) => {\n                    return (\n                        <Tooltip\n                            key={`tooltip_step_${currentStepIndex}_${t}`}\n                            count={i}\n                            // display one by one\n                            data={victimData[t - 1]}\n                            stepIndex={2}\n                            pos={{\n                                x: tooltipPos[t - 1].x,\n                                y: tooltipPos[t - 1].y,\n                                z: 0\n                            }}\n                            currentStepIndex={currentStepIndex}\n                        />\n                    );\n                })}\n\n            {/* graphic ctn */}\n            <div\n                id=\"graphic_ctn_outer\"\n                style={{\n                    position: \"sticky\",\n                    top: 0,\n                    height: \"100vh\"\n                }}\n            >\n                <SoundControl\n                    step={currentStepIndex}\n                    onSouncControlClick={onSouncControlClick}\n                    audioEnabled={audioEnabled}\n                />\n                <DeathTollDiv currentStepIndex={currentStepIndex} />\n\n                <section id=\"graphic_ctn\">\n                    {\n                        currentStepIndex >= 11 &&\n                        <SearchBar\n                            data={njDeathData}\n                            setClickedIdx={setClickedIdx}\n                        />\n                    }\n                    <Scene\n                        step={currentStepIndex}\n                        randomNumArr={randomNumArr}\n                        COUNT={COUNT}\n                        startTime={startTime}\n                        njCovidArr={njCovidArr}\n                        clickedIdx={clickedIdx}\n                        deathData={njDeathData}\n                        pointByCountyPosWithName={pointByCountyPosWithName}\n                        isMobile={isMobile}\n                        width={screenSize.width}\n                    />\n                </section>\n                <div className=\"step__ctn\" ref={stepCtnRef}>\n                    {step.map((data, stepIndex) => (\n                        <Step\n                            key={`step__${stepIndex}`}\n                            data={data}\n                            stepIndex={stepIndex}\n                            currentStepIndex={currentStepIndex}\n                        />\n                    ))}\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport default memo(MainCtn);\n","import React from \"react\";\nimport MainCtn from \"./MainCtn\";\n\n\nexport default function Main() {\n    return (\n        <main>\n            <MainCtn />\n            {/* <Credits data={copy[\"credits-section\"]} /> */}\n        </main>\n    );\n}\n","import React, { Component } from \"react\";\nimport copy from \"../data/copy.json\";\n\nclass Navbar extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      searchValue: \"search\",\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  handleChange(event) {\n    this.setState({ searchValue: event.target.value });\n  }\n\n  handleSubmit(event) {\n    window.open(`https://nj.com/search?q=${this.state.searchValue}`);\n    event.preventDefault();\n  }\n\n  render() {\n    let njdcLinks = [];\n\n    for (const link in copy.navbarLinks) {\n      const current = copy.navbarLinks[link];\n      njdcLinks.push(\n        <a\n          key={link}\n          href={current.link}\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          {current.text}\n        </a>\n      );\n    }\n\n    function facebookShare() {\n      window.open(\n        `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(\n          copy.social.site_url\n        )}`,\n        \"facebook-share-dialog\",\n        \"width=626,height=436\"\n      );\n      return false;\n    }\n\n    function onMouseEnter() {\n        document.querySelector(\".credit-page\").classList.add(\"active\");\n    }\n    return (\n        <section id=\"navbar\">\n            <div className=\"navbar-logo\">\n                <a\n                    href=\"https://www.nj.com/\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                >\n                    <img\n                        src=\"./assets/images/njdotcomlogowhite.png\"\n                        alt=\"nj.com logo\"\n                        style={{ padding: `5px 0px 4px 5px`, width: `50px` }}\n                    />\n                </a>\n            </div>\n\n            <div className=\"navbar-social\">\n                <div className=\"button-container\">\n                    <a\n                        href=\"./\"\n                        className=\"credit-btn\"\n                        onMouseEnter={onMouseEnter}\n                    >\n                        About\n                    </a>\n                </div>\n                <div className=\"button-container\">\n                    <a\n                        href=\"https://www.nj.com/digitalsubscription/inline/?utm_source=INL&utm_medium=ACQ-ADH0-1030a&utm_campaign=ACQ\"\n                        className=\"sub-button\"\n                    >\n                        subscribe\n                    </a>\n                </div>\n                <a\n                    href=\"/\"\n                    onClick={facebookShare}\n                    className=\"social-button nav-soc\"\n                >\n                    <img\n                        src=\"./assets/images/white-facebook.png\"\n                        alt=\"share using facebook\"\n                        style={{ padding: `17px 8px 12px 13px`, height: `87%` }}\n                    />\n                </a>\n                <a\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    href={`https://twitter.com/intent/tweet?url=${copy.social.site_url}&text=${copy.social.description}`}\n                    data-size=\"large\"\n                    className=\"social-button nav-soc\"\n                >\n                    <img\n                        src=\"./assets/images/white-Twitter.png\"\n                        alt=\"share using twitter\"\n                        style={{ padding: `12px 5px 2px 5px`, height: `80%` }}\n                    />\n                </a>\n                <a\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    href={`mailto:?subject=${copy.social.email_subj}&body=${copy.social.email_body}`}\n                    className=\"social-button nav-soc\"\n                >\n                    <img\n                        src=\"./assets/images/envelope.png\"\n                        alt=\"share using email\"\n                        style={{ padding: `14px 9px 2px 5px`, height: `75%` }}\n                    />\n                </a>\n            </div>\n        </section>\n    );\n  }\n}\n\nexport default Navbar;\n","import React, { Component } from 'react'\nimport Main from \"./Main\"\nimport Navbar from \"./Navbar\"\nimport { isIE } from 'react-device-detect';\nclass App extends Component {\n    render() {\n        if (isIE)\n            return (\n                <div> IE is not supported. Download Chrome/Opera/Firefox </div>\n            );\n            \n        return(\n            <div className=\"App\">\n                    <Navbar />\n                    <Main />\n            </div>\n        )\n    }\n}\n\nexport default App","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./js/App\";\nimport \"./index.css\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}